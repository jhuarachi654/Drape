<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DRAPE â€” My Closet</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300&family=DM+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --bg: #f0ece4; --surface: #e8e2d8; --dark: #1a1714;
    --mid: #6b6560; --accent: #c8a98a; --white: #faf8f4;
    --border: rgba(26,23,20,0.1); --drawer-h: 180px;
  }
  body { font-family: 'DM Mono', monospace; background: var(--bg); color: var(--dark); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
  body::before { content: ''; position: fixed; inset: 0; pointer-events: none; z-index: 200; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.035'/%3E%3C/svg%3E"); opacity: 0.6; }
  header { display: flex; align-items: center; justify-content: space-between; padding: 18px 32px; border-bottom: 1px solid var(--border); flex-shrink: 0; background: var(--bg); z-index: 10; }
  .logo { font-family: 'Cormorant Garamond', serif; font-size: 26px; font-weight: 300; letter-spacing: 0.22em; }
  .logo em { font-style: italic; color: var(--accent); }
  .header-right { display: flex; align-items: center; gap: 20px; }
  .model-upload-btn { font-size: 9px; letter-spacing: 0.15em; text-transform: uppercase; color: var(--mid); cursor: pointer; border: 1px solid var(--border); padding: 7px 14px; border-radius: 100px; background: var(--white); transition: all 0.2s; white-space: nowrap; }
  .model-upload-btn:hover { border-color: var(--accent); color: var(--dark); }
  #modelFileInput { display: none; }
  .outfit-label { font-size: 9px; letter-spacing: 0.15em; color: var(--mid); text-transform: uppercase; max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .stage { flex: 1; display: grid; grid-template-columns: 72px 1fr 72px; align-items: center; overflow: hidden; position: relative; }
  .arrow-col { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 28px; height: 100%; padding: 16px 0; }
  .category-block { display: flex; flex-direction: column; align-items: center; gap: 6px; }
  .cat-label { font-size: 8px; letter-spacing: 0.18em; text-transform: uppercase; color: var(--mid); writing-mode: vertical-rl; transform: rotate(180deg); }
  .arrow-btn { width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--border); background: var(--white); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; color: var(--dark); transition: all 0.15s; flex-shrink: 0; }
  .arrow-btn:hover:not(:disabled) { background: var(--accent); border-color: var(--accent); color: var(--white); }
  .arrow-btn:disabled { opacity: 0.2; cursor: not-allowed; }
  .item-counter { font-size: 8px; color: var(--mid); letter-spacing: 0.1em; text-align: center; min-width: 28px; }
  .canvas-wrap { position: relative; height: 100%; display: flex; align-items: center; justify-content: center; overflow: hidden; }
  .model-stack { position: relative; height: 90%; max-height: 620px; aspect-ratio: 9/16; }
  .model-stack img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: contain; object-position: center; }
  #modelBase { z-index: 1; }
  #overlayTop { z-index: 2; }
  #overlayBottom { z-index: 3; }
  #overlayShoes { z-index: 4; }
  .empty-model { position: absolute; inset: 0; z-index: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 12px; border: 1.5px dashed var(--border); border-radius: 20px; background: var(--white); cursor: pointer; }
  .empty-model p { font-size: 10px; color: var(--mid); text-align: center; line-height: 1.7; }
  .empty-model span { font-size: 28px; }
  #overlayTop, #overlayBottom, #overlayShoes { opacity: 0; transition: opacity 0.3s ease; }
  #overlayTop.on, #overlayBottom.on, #overlayShoes.on { opacity: 1; }
  .drawer { height: var(--drawer-h); border-top: 1px solid var(--border); background: var(--white); flex-shrink: 0; display: flex; flex-direction: column; overflow: hidden; transition: height 0.35s cubic-bezier(0.4,0,0.2,1); z-index: 10; }
  .drawer.collapsed { height: 40px; }
  .drawer-header { display: flex; align-items: center; justify-content: space-between; padding: 0 24px; height: 40px; flex-shrink: 0; cursor: pointer; user-select: none; }
  .drawer-title { font-size: 9px; letter-spacing: 0.2em; text-transform: uppercase; color: var(--mid); }
  .drawer-toggle { font-size: 11px; color: var(--mid); transition: transform 0.3s; }
  .drawer.collapsed .drawer-toggle { transform: rotate(180deg); }
  .drawer-tabs { display: flex; border-bottom: 1px solid var(--border); padding: 0 24px; flex-shrink: 0; }
  .drawer-tab { font-size: 9px; letter-spacing: 0.15em; text-transform: uppercase; padding: 8px 16px; cursor: pointer; color: var(--mid); border-bottom: 2px solid transparent; margin-bottom: -1px; transition: all 0.2s; }
  .drawer-tab.active { color: var(--dark); border-bottom-color: var(--accent); }
  .drawer-body { flex: 1; overflow-x: auto; overflow-y: hidden; display: flex; align-items: center; gap: 12px; padding: 12px 24px; }
  .drawer-body::-webkit-scrollbar { height: 3px; }
  .drawer-body::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }
  .inv-item { flex-shrink: 0; width: 72px; height: 96px; border-radius: 10px; border: 1.5px solid var(--border); overflow: hidden; cursor: pointer; background: var(--bg); transition: all 0.15s; position: relative; }
  .inv-item:hover { border-color: var(--accent); transform: translateY(-2px); }
  .inv-item.active { border-color: var(--dark); box-shadow: 0 0 0 1px var(--dark); }
  .inv-item img { width: 100%; height: 100%; object-fit: cover; }
  .inv-item .remove-x { position: absolute; top: 3px; right: 3px; width: 16px; height: 16px; border-radius: 50%; background: rgba(26,23,20,0.65); color: #fff; font-size: 9px; display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.15s; cursor: pointer; z-index: 2; }
  .inv-item:hover .remove-x { opacity: 1; }
  .add-item-btn { flex-shrink: 0; width: 72px; height: 96px; border-radius: 10px; border: 1.5px dashed var(--border); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; cursor: pointer; background: transparent; transition: all 0.15s; color: var(--mid); }
  .add-item-btn:hover { border-color: var(--accent); color: var(--accent); }
  .add-item-btn span { font-size: 20px; line-height: 1; }
  .add-item-btn p { font-size: 8px; letter-spacing: 0.08em; text-align: center; line-height: 1.4; }
  #itemFileInput { display: none; }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
  header { animation: fadeUp 0.4s ease both; }
  .stage  { animation: fadeUp 0.4s ease 0.08s both; }
  .drawer { animation: fadeUp 0.4s ease 0.15s both; }
</style>
</head>
<body>

<header>
  <div class="logo">DR<em>A</em>PE</div>
  <div class="header-right">
    <label class="model-upload-btn" for="modelFileInput">ï¼‹ Set my photo</label>
    <input type="file" id="modelFileInput" accept="image/*">
    <span class="outfit-label" id="outfitLabel">no outfit selected</span>
  </div>
</header>

<div class="stage">
  <div class="arrow-col">
    <div class="category-block">
      <span class="cat-label">Top</span>
      <button class="arrow-btn" onclick="swipe('tops',-1)">â€¹</button>
      <span class="item-counter" id="topCounter">â€”</span>
      <button class="arrow-btn" onclick="swipe('tops',1)">â€º</button>
    </div>
    <div class="category-block">
      <span class="cat-label">Bottom</span>
      <button class="arrow-btn" onclick="swipe('bottoms',-1)">â€¹</button>
      <span class="item-counter" id="botCounter">â€”</span>
      <button class="arrow-btn" onclick="swipe('bottoms',1)">â€º</button>
    </div>
    <div class="category-block">
      <span class="cat-label">Shoes</span>
      <button class="arrow-btn" onclick="swipe('shoes',-1)">â€¹</button>
      <span class="item-counter" id="shoeCounter">â€”</span>
      <button class="arrow-btn" onclick="swipe('shoes',1)">â€º</button>
    </div>
  </div>

  <div class="canvas-wrap">
    <div class="model-stack">
      <div class="empty-model" id="emptyModel" onclick="document.getElementById('modelFileInput').click()">
        <span>ðŸ‘¤</span>
        <p>Tap to set<br>your photo</p>
      </div>
      <img id="modelBase" src="" alt="Model" style="display:none;">
      <img id="overlayTop"    src="" alt="Top">
      <img id="overlayBottom" src="" alt="Bottom">
      <img id="overlayShoes"  src="" alt="Shoes">
    </div>
  </div>

  <div></div>
</div>

<div class="drawer" id="drawer">
  <div class="drawer-header" onclick="toggleDrawer()">
    <span class="drawer-title">My Wardrobe</span>
    <span class="drawer-toggle">â–²</span>
  </div>
  <div class="drawer-tabs">
    <div class="drawer-tab active" onclick="switchTab('tops')"    id="tab-tops">Tops</div>
    <div class="drawer-tab"        onclick="switchTab('bottoms')" id="tab-bottoms">Bottoms</div>
    <div class="drawer-tab"        onclick="switchTab('shoes')"   id="tab-shoes">Shoes</div>
  </div>
  <div class="drawer-body" id="drawerBody"></div>
</div>

<input type="file" id="itemFileInput" accept="image/*">

<script>
  const wardrobe = { tops: [], bottoms: [], shoes: [] };
  const current  = { tops: -1, bottoms: -1, shoes: -1 };
  let activeTab  = 'tops';

  const modelBase     = document.getElementById('modelBase');
  const emptyModel    = document.getElementById('emptyModel');
  const overlayTop    = document.getElementById('overlayTop');
  const overlayBottom = document.getElementById('overlayBottom');
  const overlayShoes  = document.getElementById('overlayShoes');
  const outfitLabel   = document.getElementById('outfitLabel');
  const drawerBody    = document.getElementById('drawerBody');
  const itemFileInput = document.getElementById('itemFileInput');

  const overlays = { tops: overlayTop, bottoms: overlayBottom, shoes: overlayShoes };
  const counters = {
    tops:    document.getElementById('topCounter'),
    bottoms: document.getElementById('botCounter'),
    shoes:   document.getElementById('shoeCounter'),
  };

  document.getElementById('modelFileInput').addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (!file) return;
    modelBase.src = URL.createObjectURL(file);
    modelBase.style.display = 'block';
    emptyModel.style.display = 'none';
  });

  function swipe(cat, dir) {
    const items = wardrobe[cat];
    if (!items.length) return;
    let idx = current[cat] + dir;
    if (idx < -1) idx = items.length - 1;
    if (idx >= items.length) idx = -1;
    current[cat] = idx;
    applyOverlay(cat);
    updateCounter(cat);
    updateOutfitLabel();
    renderInventory();
  }

  function jumpTo(cat, idx) {
    current[cat] = idx;
    applyOverlay(cat);
    updateCounter(cat);
    updateOutfitLabel();
    renderInventory();
  }

  function applyOverlay(cat) {
    const el  = overlays[cat];
    const idx = current[cat];
    if (idx === -1) { el.src = ''; el.classList.remove('on'); }
    else            { el.src = wardrobe[cat][idx].url; el.classList.add('on'); }
  }

  function updateCounter(cat) {
    const items = wardrobe[cat];
    const idx   = current[cat];
    counters[cat].textContent = items.length
      ? (idx === -1 ? `â€”/${items.length}` : `${idx+1}/${items.length}`)
      : 'â€”';
  }

  function updateOutfitLabel() {
    const parts = [];
    if (current.tops    >= 0) parts.push(wardrobe.tops[current.tops].name);
    if (current.bottoms >= 0) parts.push(wardrobe.bottoms[current.bottoms].name);
    if (current.shoes   >= 0) parts.push(wardrobe.shoes[current.shoes].name);
    outfitLabel.textContent = parts.length ? parts.join(' Â· ') : 'no outfit selected';
  }

  let pendingCat = null;
  function addItem(cat) {
    pendingCat = cat;
    itemFileInput.value = '';
    itemFileInput.click();
  }

  itemFileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (!file || !pendingCat) return;
    const url  = URL.createObjectURL(file);
    const name = file.name.replace(/\.[^.]+$/, '').replace(/[-_]/g, ' ');
    wardrobe[pendingCat].push({ url, name });
    current[pendingCat] = wardrobe[pendingCat].length - 1;
    applyOverlay(pendingCat);
    updateCounter(pendingCat);
    updateOutfitLabel();
    renderInventory();
  });

  function removeItem(cat, idx, e) {
    e.stopPropagation();
    wardrobe[cat].splice(idx, 1);
    if (current[cat] >= wardrobe[cat].length) current[cat] = wardrobe[cat].length - 1;
    applyOverlay(cat);
    updateCounter(cat);
    updateOutfitLabel();
    renderInventory();
  }

  function renderInventory() {
    const cat   = activeTab;
    const items = wardrobe[cat];
    drawerBody.innerHTML = '';
    items.forEach((item, i) => {
      const el = document.createElement('div');
      el.className = 'inv-item' + (current[cat] === i ? ' active' : '');
      el.innerHTML = `<img src="${item.url}" alt="${item.name}"><div class="remove-x" onclick="removeItem('${cat}',${i},event)">âœ•</div>`;
      el.addEventListener('click', () => jumpTo(cat, i));
      drawerBody.appendChild(el);
    });
    const addBtn = document.createElement('div');
    addBtn.className = 'add-item-btn';
    addBtn.innerHTML = `<span>ï¼‹</span><p>Add ${cat.slice(0,-1)}</p>`;
    addBtn.onclick = () => addItem(cat);
    drawerBody.appendChild(addBtn);
  }

  function switchTab(cat) {
    activeTab = cat;
    document.querySelectorAll('.drawer-tab').forEach(t => t.classList.remove('active'));
    document.getElementById('tab-' + cat).classList.add('active');
    renderInventory();
  }

  function toggleDrawer() {
    document.getElementById('drawer').classList.toggle('collapsed');
  }

  renderInventory();
  Object.keys(wardrobe).forEach(updateCounter);
</script>
</body>
</html>
